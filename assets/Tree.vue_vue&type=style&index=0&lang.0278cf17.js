var Pe=Object.defineProperty,Ue=Object.defineProperties;var He=Object.getOwnPropertyDescriptors;var de=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var ue=(e,o,k)=>o in e?Pe(e,o,{enumerable:!0,configurable:!0,writable:!0,value:k}):e[o]=k,F=(e,o)=>{for(var k in o||(o={}))ze.call(o,k)&&ue(e,k,o[k]);if(de)for(var k of de(o))Xe.call(o,k)&&ue(e,k,o[k]);return e},G=(e,o)=>Ue(e,He(o));var he=(e,o,k)=>new Promise((K,L)=>{var c=C=>{try{A(k.next(C))}catch(v){L(v)}},p=C=>{try{A(k.throw(C))}catch(v){L(v)}},A=C=>C.done?K(C.value):Promise.resolve(C.value).then(c,p);A((k=k.apply(e,o)).next())});import{z as Ye,A as ye,aB as Ge,aA as Q,ao as Je,r as fe,j,S as O,T as We,a0 as m,B as M,D as U,a7 as qe,ad as V,a1 as Z,a6 as H,ae as ke,J as ge,K as Qe,w as S,ab as R,ap as Ze,aC as Re,aS as et,ay as tt,u as h,n as pe,P as Ke,t as z,c6 as nt,o as xe,am as X,_ as st,bw as ct,F as Se,G as be,c7 as _e,a4 as ve,as as Ce,bx as ee}from"./vendor.223c82b6.js";import{j as at,I as te,az as lt,p as b,b as rt,_ as it,aV as Ae,a as ot,aj as dt,i as ne,aW as ut,aC as ht,ay as Te,S as yt,aX as ft,B as Le,ae as kt}from"./index.a20e0ed4.js";import{u as gt}from"./useContextMenu.bc08b6e9.js";const pt=({icon:e})=>e?at(e)?Ye(te,{icon:e,class:"mr-1"}):te:null;var Ne;(function(e){e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY"})(Ne||(Ne={}));const Kt=ye({name:"BasicTreeHeader",components:{BasicTitle:lt,Icon:te,Dropdown:Ge,Menu:Q,MenuItem:Q.Item,MenuDivider:Q.Divider,InputSearch:Je.Search},props:{helpMessage:{type:[String,Array],default:""},title:b.string,toolbar:b.bool,checkable:b.bool,search:b.bool,checkAll:b.func,expandAll:b.func,searchText:b.string},emits:["strictly-change","search"],setup(e,{emit:o,slots:k}){const{t:K}=rt(),L=fe(""),c=j(()=>{const n=k.headerTitle||e.title;return["mr-1","w-full",{["ml-5"]:n}]}),p=j(()=>{const{checkable:n}=e,a=[{label:K("component.tree.expandAll"),value:2},{label:K("component.tree.unExpandAll"),value:3,divider:n}];return n?[{label:K("component.tree.selectAll"),value:0},{label:K("component.tree.unSelectAll"),value:1,divider:n},...a,{label:K("component.tree.checkStrictly"),value:4},{label:K("component.tree.checkUnStrictly"),value:5}]:a});function A(n){var r,s,d,l;const{key:a}=n;switch(a){case 0:(r=e.checkAll)==null||r.call(e,!0);break;case 1:(s=e.checkAll)==null||s.call(e,!1);break;case 2:(d=e.expandAll)==null||d.call(e,!0);break;case 3:(l=e.expandAll)==null||l.call(e,!1);break;case 4:o("strictly-change",!1);break;case 5:o("strictly-change",!0);break}}function C(n){o("search",n)}const v=We(C,200);return O(()=>L.value,n=>{v(n)}),O(()=>e.searchText,n=>{n!==L.value&&(L.value=n)}),{t:K,toolbarList:p,handleMenuClick:A,searchValue:L,getInputSearchCls:c}}}),xt={class:"flex px-2 py-1.5 items-center basic-tree-header"},St={key:2,class:"flex flex-1 justify-self-stretch items-center cursor-pointer"};function bt(e,o,k,K,L,c){const p=m("BasicTitle"),A=m("InputSearch"),C=m("Icon"),v=m("MenuItem"),n=m("MenuDivider"),a=m("Menu"),r=m("Dropdown");return M(),U("div",xt,[e.$slots.headerTitle?qe(e.$slots,"headerTitle",{key:0},void 0,!0):V("",!0),!e.$slots.headerTitle&&e.title?(M(),Z(p,{key:1,helpMessage:e.helpMessage},{default:H(()=>[ke(ge(e.title),1)]),_:1},8,["helpMessage"])):V("",!0),e.search||e.toolbar?(M(),U("div",St,[e.search?(M(),U("div",{key:0,class:Qe(e.getInputSearchCls)},[S(A,{placeholder:e.t("common.searchText"),size:"small",allowClear:"",value:e.searchValue,"onUpdate:value":o[0]||(o[0]=s=>e.searchValue=s)},null,8,["placeholder","value"])],2)):V("",!0),e.toolbar?(M(),Z(r,{key:1,onClick:o[1]||(o[1]=tt(()=>{},["prevent"]))},{overlay:H(()=>[S(a,{onClick:e.handleMenuClick},{default:H(()=>[(M(!0),U(R,null,Ze(e.toolbarList,s=>(M(),U(R,{key:s.value},[S(v,Re(et({key:s.value})),{default:H(()=>[ke(ge(s.label),1)]),_:2},1040),s.divider?(M(),Z(n,{key:0})):V("",!0)],64))),128))]),_:1},8,["onClick"])]),default:H(()=>[S(C,{icon:"ion:ellipsis-vertical"})]),_:1})):V("",!0)])):V("",!0)])}var _t=it(Kt,[["render",bt],["__scopeId","data-v-05dbfd0e"]]);function vt(e,o){function k(n){const a=[],r=n||h(e),{key:s,children:d}=h(o);if(!d||!s)return a;for(let l=0;l<r.length;l++){const i=r[l];a.push(i[s]);const f=i[d];f&&f.length&&a.push(...k(f))}return a}function K(n){const a=[],r=n||h(e),{key:s,children:d}=h(o);if(!d||!s)return a;for(let l=0;l<r.length;l++){const i=r[l];i.disabled!==!0&&i.selectable!==!1&&a.push(i[s]);const f=i[d];f&&f.length&&a.push(...K(f))}return a}function L(n,a){const r=[],s=a||h(e),{key:d,children:l}=h(o);if(!l||!d)return r;for(let i=0;i<s.length;i++){const f=s[i],T=f[l];n===f[d]?(r.push(f[d]),T&&T.length&&r.push(...k(T))):T&&T.length&&r.push(...L(n,T))}return r}function c(n,a,r){if(!n)return;const s=r||h(e),{key:d,children:l}=h(o);if(!(!l||!d))for(let i=0;i<s.length;i++){const f=s[i],T=f[l];if(f[d]===n){s[i]=F(F({},s[i]),a);break}else T&&T.length&&c(n,a,f[l])}}function p(n=1,a,r=1){if(!n)return[];const s=[],d=a||h(e)||[];for(let l=0;l<d.length;l++){const i=d[l],{key:f,children:T}=h(o),J=f?i[f]:"",P=T?i[T]:[];s.push(J),P&&P.length&&r<n&&(r+=1,s.push(...p(n,P,r)))}return s}function A({parentKey:n=null,node:a,push:r="push"}){const s=pe(h(e));if(!n){s[r](a),e.value=s;return}const{key:d,children:l}=h(o);!l||!d||(Ae(s,i=>{if(i[d]===n)return i[l]=i[l]||[],i[l][r](a),!0}),e.value=s)}function C({parentKey:n=null,list:a,push:r="push"}){const s=pe(h(e));if(!(!a||a.length<1))if(n){const{key:d,children:l}=h(o);if(!l||!d)return;Ae(s,i=>{if(i[d]===n){i[l]=i[l]||[];for(let f=0;f<a.length;f++)i[l][r](a[f]);return e.value=s,!0}})}else for(let d=0;d<a.length;d++)s[r](a[d])}function v(n,a){if(!n)return;const r=a||h(e),{key:s,children:d}=h(o);if(!(!d||!s))for(let l=0;l<r.length;l++){const i=r[l],f=i[d];if(i[s]===n){r.splice(l,1);break}else f&&f.length&&v(n,i[d])}}return{deleteNodeByKey:v,insertNodeByKey:A,insertNodesByKey:C,filterByLevel:p,updateNodeByKey:c,getAllKeys:k,getChildrenKeys:L,getEnabledKeys:K}}const Ct={value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:b.string,toolbar:b.bool,search:b.bool,searchValue:b.string,checkStrictly:b.bool,clickRowToExpand:b.bool.def(!0),checkable:b.bool.def(!1),defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:b.bool.def(!1),replaceFields:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:null},rightMenuList:{type:Array},filterFn:{type:Function,default:null},highlight:{type:[Boolean,String],default:!1},expandOnSearch:b.bool.def(!1),checkOnSearch:b.bool.def(!1),selectedOnSearch:b.bool.def(!1)};function At(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ct(e)}var Ft=ye({name:"BasicTree",inheritAttrs:!1,props:Ct,emits:["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],setup(e,{attrs:o,slots:k,emit:K,expose:L}){const c=Ke({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=Ke({startSearch:!1,searchText:"",searchData:[]}),A=fe([]),[C]=gt(),{prefixCls:v}=ot("basic-tree"),n=j(()=>{const{replaceFields:t}=e;return F({children:"children",title:"title",key:"key"},t)}),a=j(()=>{let t=G(F(F({blockNode:!0},o),e),{expandedKeys:c.expandedKeys,selectedKeys:c.selectedKeys,checkedKeys:c.checkedKeys,checkStrictly:c.checkStrictly,replaceFields:h(n),"onUpdate:expandedKeys":y=>{c.expandedKeys=y,K("update:expandedKeys",y)},"onUpdate:selectedKeys":y=>{c.selectedKeys=y,K("update:selectedKeys",y)},onCheck:(y,g)=>{let x=z(c.checkedKeys);if(dt(x)&&p.startSearch){const{key:_}=h(n);x=nt(x,P(g.node.$attrs.node[_])),g.checked&&x.push(g.node.$attrs.node[_]),c.checkedKeys=x}else c.checkedKeys=y;const u=z(c.checkedKeys);K("update:value",u),K("check",u,g)},onRightClick:Fe});return xe(t,"treeData","class")}),r=j(()=>p.startSearch?p.searchData:h(A)),s=j(()=>!r.value||r.value.length===0),{deleteNodeByKey:d,insertNodeByKey:l,insertNodesByKey:i,filterByLevel:f,updateNodeByKey:T,getAllKeys:J,getChildrenKeys:P,getEnabledKeys:Ee}=vt(A,n);function De(t,y){return!y&&e.renderIcon&&ne(e.renderIcon)?e.renderIcon(t):y}function Fe(g){return he(this,arguments,function*({event:t,node:y}){var D;const{rightMenuList:x=[],beforeRightClick:u}=e;let _={event:t,items:[]};if(u&&ne(u)){let N=yield u(y,t);Array.isArray(N)?_.items=N:Object.assign(_,N)}else _.items=x;!((D=_.items)==null?void 0:D.length)||C(_)})}function Y(t){c.expandedKeys=t}function Me(){return c.expandedKeys}function se(t){c.selectedKeys=t}function we(){return c.selectedKeys}function ce(t){c.checkedKeys=t}function Ie(){return c.checkedKeys}function ae(t){c.checkedKeys=t?Ee():[]}function W(t){c.expandedKeys=t?J():[]}function me(t){c.checkStrictly=t}O(()=>e.searchValue,t=>{t!==p.searchText&&(p.searchText=t)},{immediate:!0}),O(()=>e.treeData,t=>{t&&q(p.searchText)});function q(t){if(t!==p.searchText&&(p.searchText=t),K("update:searchValue",t),!t){p.startSearch=!1;return}const{filterFn:y,checkable:g,expandOnSearch:x,checkOnSearch:u,selectedOnSearch:_}=h(e);p.startSearch=!0;const{title:D,key:N}=h(n),w=[];if(p.searchData=ut(h(A),E=>{var I,$;const B=y?y(t,E,h(n)):($=(I=E[D])==null?void 0:I.includes(t))!=null?$:!1;return B&&w.push(E[N]),B},h(n)),x){const E=ht(p.searchData).map(B=>B[N]);E&&E.length&&Y(E)}u&&g&&w.length&&ce(w),_&&w.length&&se(w)}function Be(t,y){if(!(!e.clickRowToExpand||!y||y.length===0))if(!c.expandedKeys.includes(t))Y([...c.expandedKeys,t]);else{const g=[...c.expandedKeys],x=g.findIndex(u=>u===t);x!==-1&&g.splice(x,1),Y(g)}}X(()=>{A.value=e.treeData}),st(()=>{const t=parseInt(e.defaultExpandLevel);t>0?c.expandedKeys=f(t):e.defaultExpandAll&&W(!0)}),X(()=>{c.expandedKeys=e.expandedKeys}),X(()=>{c.selectedKeys=e.selectedKeys}),X(()=>{c.checkedKeys=e.checkedKeys}),O(()=>e.value,()=>{c.checkedKeys=z(e.value||[])}),O(()=>c.checkedKeys,()=>{const t=z(c.checkedKeys);K("update:value",t),K("change",t)}),X(()=>{c.checkStrictly=e.checkStrictly}),L({setExpandedKeys:Y,getExpandedKeys:Me,setSelectedKeys:se,getSelectedKeys:we,setCheckedKeys:ce,getCheckedKeys:Ie,insertNodeByKey:l,insertNodesByKey:i,deleteNodeByKey:d,updateNodeByKey:T,checkAll:ae,expandAll:W,filterByLevel:t=>{c.expandedKeys=f(t)},setSearchValue:t=>{q(t)},getSearchValue:()=>p.searchText});function $e(t){const{actionList:y}=e;if(!(!y||y.length===0))return y.map((g,x)=>{var _;let u=!0;return ne(g.show)?u=(_=g.show)==null?void 0:_.call(g,t):Le(g.show)&&(u=g.show),u?S("span",{key:x,class:`${v}__action`},[g.render(t)]):null})}function le({data:t,level:y}){if(!t)return null;const g=p.searchText,{highlight:x}=h(e);return t.map(u=>{var re;const{title:_,key:D,children:N}=h(n),w=xe(u,"title"),E=De(G(F({},u),{level:y}),u.icon),B=ee(u,N)||[],I=ee(u,_),$=g?I.indexOf(g):-1,je=p.startSearch&&!ft(g)&&x&&$!==-1,Oe=`color: ${Le(x)?"#f50":x}`,Ve=je?S("span",{class:((re=h(a))==null?void 0:re.blockNode)?`${v}__content`:""},[S("span",null,[I.substr(0,$)]),S("span",{style:Oe},[g]),S("span",null,[I.substr($+g.length)])]):I;return S(_e.TreeNode,ve(w,{node:z(u),key:ee(u,D)}),{title:()=>{var ie,oe;return S("span",{class:`${v}-title pl-2`,onClick:Be.bind(null,u[D],u[N])},[((ie=u.slots)==null?void 0:ie.title)?kt(k,(oe=u.slots)==null?void 0:oe.title,u):S(R,null,[E&&S(pt,{icon:E},null),Ve,S("span",{class:`${v}__actions`},[$e(G(F({},u),{level:y}))])])])},default:()=>le({data:B,level:y+1})})})}return()=>{let t;const{title:y,helpMessage:g,toolbar:x,search:u,checkable:_}=e,D=y||x||u||k.headerTitle,N={height:"calc(100% - 38px)"};return S("div",{class:[v,"h-full",o.class]},[D&&S(_t,{checkable:_,checkAll:ae,expandAll:W,title:y,search:u,toolbar:x,helpMessage:g,onStrictlyChange:me,onSearch:q,searchText:p.searchText},At(t=Te(k))?t:{default:()=>[t]}),Se(S(yt,{style:N},{default:()=>[S(_e,ve(h(a),{showIcon:!1}),F({default:()=>le({data:h(r),level:1})},Te(k)))]}),[[be,!h(s)]]),Se(S(Ce,{image:Ce.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[be,h(s)]])])}}});export{Ft as _};
